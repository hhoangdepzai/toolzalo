<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Tool Quáº£n LÃ½ Zalo HoÃ ngMMO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --green:#16a34a; --green-bg:rgba(22,163,74,.15);
  --red:#dc2626; --red-bg:rgba(220,38,38,.15);
  --blue:#2563eb; --blue-dark:#1e40af;
  --bg:#020617; --card:#0b1220; --card2:#0f172a;
  --text:#e5e7eb;
}
*{box-sizing:border-box;font-family:Inter,Arial}
body{margin:0;background:radial-gradient(circle,#0f172a,#020617);color:var(--text)}
.hidden{display:none}

header{
  background:linear-gradient(90deg,var(--blue-dark),var(--blue));
  padding:18px;font-size:22px;font-weight:700;text-align:center
}
.container{max-width:1300px;margin:auto;padding:16px}
.card{
  background:linear-gradient(180deg,var(--card),var(--card2));
  padding:16px;border-radius:14px;margin-bottom:16px;
  border:1px solid #1f2937
}
h3{margin:0 0 12px;color:#bfdbfe}
input,select,textarea,button{
  width:100%;padding:12px;border-radius:12px;
  background:#020617;color:var(--text);
  border:1px solid #1f2937;margin-bottom:10px
}
button{
  background:linear-gradient(135deg,var(--blue),var(--blue-dark));
  border:none;font-weight:700;cursor:pointer
}
.row{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{padding:10px;border-bottom:1px solid #1f2937}
th{color:#93c5fd}
.tag{padding:6px 14px;border-radius:999px;font-weight:700;font-size:12px}
.can-sell{background:var(--green-bg);color:var(--green)}
.not-ready{background:var(--red-bg);color:var(--red)}
/* ===== TABLE RESPONSIVE FIX ===== */
.table-scroll{
  width:100%;
  overflow-x:auto;
}

table{
  min-width:1100px;
  white-space:nowrap;
}

td, th{
  text-align:center;
  vertical-align:middle;
}

.tag{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:120px;
  text-align:center;
}

/* MOBILE */
@media (max-width: 900px){
  table{
    font-size:13px;
  }
  .tag{
    min-width:100px;
    font-size:11px;
    padding:5px 10px;
  }
}
/* ===== Cá»˜T HÃ€NH Äá»˜NG Xáº¾P Dá»ŒC ===== */
.action-col{
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.action-col button{
  width: 100%;
  padding: 8px;
  border-radius: 10px;
  font-size: 13px;
}
#pagination{
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  flex-wrap: nowrap; /* QUAN TRá»ŒNG: khÃ´ng xuá»‘ng dÃ²ng */
}

#pagination button{
  min-width: 38px;
  height: 38px;
  border-radius: 999px;
  border: none;
  background: #020617;
  color: #e5e7eb;
  font-weight: 600;
  cursor: pointer;
}

#pagination button:hover{
  background: #1e40af;
}

#pagination button.active{
  background: #2563eb;
  color: white;
}

</style>
</head>

<body>
<header>ğŸ” TOOL QUáº¢N LÃ TÃ€I KHOáº¢N ZALO HOÃ€NGMMO</header>

<div class="container">

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h3>ÄÄƒng nháº­p Admin</h3>
  <input id="user" placeholder="Admin user">
  <input id="pass" type="password" placeholder="Admin password">
  <button onclick="login()">ÄÄƒng nháº­p</button>
</div>

<!-- APP -->
<div id="app" class="hidden">

<!-- DASH -->
<div class="card">
  <div class="row">
    <div><h3>ğŸ“¦ Tá»•ng acc</h3><b id="total">0</b></div>
    <div><h3>ğŸŸ¢ CÃ³ thá»ƒ bÃ¡n</h3><b id="sellable">0</b></div>
    <div><h3>ğŸ”´ ChÆ°a Ä‘á»§ ngÃ y</h3><b id="pending">0</b></div>
  </div>
</div>

<!-- ADD -->
<div class="card">
<h3>â• ThÃªm tÃ i khoáº£n</h3>
<div class="row">
  <input id="zalo" placeholder="Sá»‘ Zalo" inputmode="numeric" oninput="onlyNumber(this)">
  <input id="password" placeholder="Máº­t kháº©u">
  <select id="type">
  <option>Reg</option>
  <option>Tuáº§n</option>
  <option>ThÃ¡ng</option>
  <option>NÄƒm</option>
</select>

<select id="goodsType">
  <option value="clean">HÃ ng sáº¡ch</option>
  <option value="bad">HÃ ng bÃ¡o xáº¥u</option>
</select>

  </select>
  <select id="accStatus">
  <option value="normal">Acc bÃ¬nh thÆ°á»ng</option>
  <option value="limited">Acc háº¡n cháº¿</option>
</select>
  <input type="date" id="created">
</div>
<textarea id="note" placeholder="Ghi chÃº"></textarea>
<button id="submitBtn" onclick="addAcc()">â• ThÃªm</button>
</div>

<!-- FILTER -->
<div class="card">
<div class="row">
  <input id="search" placeholder="ğŸ” TÃ¬m sá»‘" oninput="render()">
  <select id="filter" onchange="render()">
    <option value="all">Táº¥t cáº£</option>
    <option value="can-sell">CÃ³ thá»ƒ bÃ¡n</option>
    <option value="not-ready">ChÆ°a Ä‘á»§ 7 ngÃ y</option>
  </select>
</div>
</div>


<!-- TABLE -->
<div class="card table-wrap">
  <div class="table-scroll">
    <table> 
<tr>
  <th></th>
  <th>Sá»‘</th>
  <th>Loáº¡i</th>
  <th>NgÃ y táº¡o</th>
  <th>NgÃ y Ä‘á»§ 7</th>
  <th>Loáº¡i hÃ ng</th>
  <th>Tráº¡ng thÃ¡i</th>
  <th>Ghi chÃº</th>
  <th>BÃ¡n</th>
  <th>HÃ nh Ä‘á»™ng</th>
  <th>Tráº¡ng thÃ¡i acc</th>

</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>
</div>
</div>
<div id="pagination" style="text-align:center;margin-top:15px;"></div>

<script>
const ADMIN_USER='admin';
const ADMIN_PASS='123456';

let accs=JSON.parse(localStorage.getItem('zaloAccs')||'[]');
let editingIndex = null;
let currentPage = 1;
const perPage = 10;
function login(){
  if(user.value===ADMIN_USER && pass.value===ADMIN_PASS){
    loginBox.classList.add('hidden');
    app.classList.remove('hidden');
    render();
  } else alert('Sai tÃ i khoáº£n');
}

function status(acc){
  const days=(new Date()-new Date(acc.created))/86400000;
  return days>=7?'can-sell':'not-ready';
}

function addAcc(){
  if(!zalo.value || !created.value)
    return alert('Thiáº¿u dá»¯ liá»‡u');

  const sell = new Date(created.value);
  sell.setDate(sell.getDate()+7);

  if(editingIndex === null){
    // â• THÃŠM Má»šI
    accs.push({
      zalo: zalo.value,
      pass: password.value,
      type: type.value,
      goodsType: goodsType.value,
      created: created.value,
      sell: sell.toISOString().slice(0,10),
      note: note.value,
      saleStatus: 'unsold',
      accStatus: accStatus.value
    });
  }else{
    // âœï¸ CHá»ˆNH Sá»¬A
    accs[editingIndex] = {
      ...accs[editingIndex],
      zalo: zalo.value,
      pass: password.value,
      type: type.value,
      goodsType: goodsType.value,
      created: created.value,
      sell: sell.toISOString().slice(0,10),
      note: note.value,
      accStatus: accStatus.value
    };

    editingIndex = null;
    document.getElementById('submitBtn').innerText = 'â• ThÃªm';

  }

  localStorage.setItem('zaloAccs', JSON.stringify(accs));
  render();

  zalo.value = password.value = note.value = '';
}

function render(){
  list.innerHTML = '';

  let t = accs.length;
  let s = 0;
  let p = 0;

  accs.forEach(a=>{
    if(status(a)==='can-sell') s++;
    else p++;
  });

  let filtered = accs.filter(a=>{
    if(search.value && !a.zalo.includes(search.value)) return false;
    if(filter.value!=='all' && filter.value!==status(a)) return false;
    return true;
  });

  const start = (currentPage-1)*perPage;
  const pageData = filtered.slice(start,start+perPage);

  pageData.forEach(a=>{
    const i = accs.indexOf(a);
    const st = status(a);

    list.innerHTML += `
    <tr>
      <td></td>
      <td>${a.zalo}</td>
      <td>${a.type}</td>
      <td>${formatDateVN(a.created)}</td>
      <td>${formatDateVN(a.sell)}</td>
      <td>${a.goodsType==='bad'
        ?'<span class="tag not-ready">ğŸš« HÃ ng bÃ¡o xáº¥u</span>'
        :'<span class="tag can-sell">âœ… HÃ ng sáº¡ch</span>'}</td>
      <td>${a.accStatus==='limited'
        ?'<span class="tag not-ready">âš ï¸ Acc háº¡n cháº¿</span>'
        :'<span class="tag can-sell">âœ… Acc bÃ¬nh thÆ°á»ng</span>'}</td>
      <td>${a.note||''}</td>
      <td><span class="tag ${st}">
        ${st==='can-sell'?'CÃ³ thá»ƒ bÃ¡n':'ChÆ°a Ä‘á»§ 7 ngÃ y'}
      </span></td>
      <td>${a.saleStatus==='sold'?'âœ… ÄÃƒ BÃN':'â³ CHÆ¯A BÃN'}</td>
      <td>
        <div class="action-col">
          <button onclick="editAcc(${i})">âœï¸ Sá»­a</button>
          ${a.saleStatus==='sold'
            ?`<button onclick="markUnsold(${i})">â†©ï¸ HoÃ n</button>`
            :`<button onclick="markSold(${i})">âœ”ï¸ BÃ¡n</button>`}
          <button onclick="del(${i})">ğŸ—‘ï¸ XÃ³a</button>
        </div>
      </td>
    </tr>`;
  });

  total.innerText = t;
  sellable.innerText = s;
  pending.innerText = p;

  renderPagination(filtered.length);
}


function markSold(i){
  if(!confirm('XÃ¡c nháº­n ÄÃƒ BÃN?')) return;
  accs[i].saleStatus='sold';
  localStorage.setItem('zaloAccs',JSON.stringify(accs));
  render();
}

function markUnsold(i){
  if(!confirm('HoÃ n vá» CHÆ¯A BÃN?')) return;
  accs[i].saleStatus='unsold';
  localStorage.setItem('zaloAccs',JSON.stringify(accs));
  render();
}

function del(i){
  if(confirm('XÃ³a acc?')){
    accs.splice(i,1);
    localStorage.setItem('zaloAccs',JSON.stringify(accs));
    render();
  }
}

function onlyNumber(el){
  el.value=el.value.replace(/\D/g,'');
}
function formatDateVN(dateStr){
  if(!dateStr) return '';
  const [y,m,d] = dateStr.split('-');
  return `${d}/${m}/${y}`;
}
function editAcc(i){
  const a = accs[i];
  editingIndex = i;

  // Äá»• dá»¯ liá»‡u lÃªn form
  zalo.value = a.zalo;
  password.value = a.pass;
  type.value = a.type;
  created.value = a.created;
  note.value = a.note || '';
  accStatus.value = a.accStatus || 'normal';
  goodsType.value = a.goodsType || 'clean';

  document.getElementById('submitBtn').innerText = 'ğŸ’¾ LÆ°u chá»‰nh sá»­a';

  // ğŸ”½ Tá»° Äá»˜NG TRÆ¯á»¢T LÃŠN FORM CHá»ˆNH Sá»¬A
  const editCard = document.querySelector('input#zalo').closest('.card');
  editCard.scrollIntoView({
    behavior: 'smooth',
    block: 'start'
  });

  // ğŸ¯ Tá»° Äá»˜NG Äáº¶T CON TRá» VÃ€O Ã” ZALO
  setTimeout(() => {
    zalo.focus();
  }, 500);
}
function renderPagination(totalItems){
  const totalPages = Math.ceil(totalItems / perPage);
  let html = '';

  if(currentPage > 1){
    html += `<button onclick="goPage(${currentPage-1})">â—€</button>`;
  }

  for(let p = 1; p <= totalPages; p++){
    html += `
      <button
        class="${p === currentPage ? 'active' : ''}"
        onclick="goPage(${p})">
        ${p}
      </button>`;
  }

  if(currentPage < totalPages){
    html += `<button onclick="goPage(${currentPage+1})">â–¶</button>`;
  }

  pagination.innerHTML = html;
}


function goPage(p){
  currentPage = p;
  render();
}

</script>
</body>
</html>
